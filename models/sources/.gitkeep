-- models/staging/stg_tiktok_videos.sql

with base as (
    select
        id as video_id,
        text as caption,
        created_at as created_at_timestamp,
        authorMeta.id as author_id,
        authorMeta.name as author_name,
        authorMeta.nickName as author_nickname,
        musicMeta.musicId as music_id,
        musicMeta.musicName as music_name,
        musicMeta.musicAuthor as music_author,
        diggCount as likes_count,
        shareCount as shares_count,
        playCount as play_count,
        commentCount as comment_count
    from 
        {{ source('raw', 'tiktok_videos') }}
)

select * from base
